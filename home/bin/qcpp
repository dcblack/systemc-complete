#!/bin/bash
#
# Quick C++ compile (unconditional)
#
# Dependencies: DO

if [[ $# == 0 ]]; then
  SRCS="$(echo *.cpp)"
else
  SRCS="$*"
fi

test -z "$CXX"  && CXX="clang++"
test -z "$CSTD" && CSTD=17
test -z "$INCS" && INCS="-I ."
test -z "$LIBD" && LIBD=""
test -z "$LIBS" && LIBS="-lm"
test -z "$CEXE" && CEXE="./run.x"

export LOGFILE='compile.log'
rm -f $CEXE *.o
for FILE in $SRCS; do
  DO $CXX -std=c++$CSTD --pedantic -Wall $INCS -c $FILE
done
export LOGFILE='link.log'
DO $CXX $LIBD $LIBS -o $CEXE *.o
export LOGFILE='run.log'
test -x $CEXE && $CEXE "$@"
